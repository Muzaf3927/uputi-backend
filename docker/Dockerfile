FROM php:8.2-fpm

WORKDIR /var/www

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω—É–∂–Ω—ã–µ –ø–∞–∫–µ—Ç—ã
RUN apt-get update && apt-get install -y \
    build-essential \
    libpng-dev \
    libonig-dev \
    libxml2-dev \
    libzip-dev \
    libpq-dev \
    zip \
    unzip \
    curl \
    git \
    nano

# üëâ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω—É–∂–Ω—ã–µ PHP-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
# –ë—ã–ª pdo_mysql ‚Äî —É–¥–∞–ª—ë–Ω
RUN docker-php-ext-install pdo pdo_pgsql mbstring zip exif pcntl

# –ö–æ–ø–∏—Ä—É–µ–º –ø—Ä–æ–µ–∫—Ç
COPY . /var/www

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Composer
RUN curl -sS https://getcomposer.org/installer | php && \
    mv composer.phar /usr/local/bin/composer

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Node.js (18)
RUN curl -fsSL https://deb.nodesource.com/setup_18.x | bash - && \
    apt-get install -y nodejs

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Laravel
RUN composer install

EXPOSE 8000

CMD ["php", "artisan", "serve", "--host=0.0.0.0", "--port=8000"]
